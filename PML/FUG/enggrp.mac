-- !a = !!ce.deslnk[1].ownlst[3].name
-- !n = '/TAGS' + !a
-- !!ce.:TgValveRefObPipe = !n.dbref()

!tmpce = !!ce

if !tmpce.type ne 'ENGGRP' then
	ENGGRP
	handle any
		$P not ENGGRP
		$!tmpce
		RETURN
	endhandle
else
	!enggrp = !!ce
endif

var !tg coll all :TgObValve for $!enggrp

!size = !tg.size()
$P $!size

!outArr = array()

do !eaTg values !tg
	!dbTg = !eaTg.dbref()
	!name = !dbTg.name
	!pipeName = !dbTg.deslnk[1].ownlst[3].name
	handle any
		$P error in $!name
		SKIP
	endhandle
	!tgPipeName = '/TAGS' + !pipeName
	!dbTgPipe = !tgPipeName.dbref()
	handle any
		$P tg $!name has error!
		SKIP
	endhandle
	
	!string = !name + ' ' + !tgPipeName
	!outArr.append(!string)
	
	!dbTg.:TgValveRefObPipe = !dbTgPipe
	handle any
		$P $!string is error
	endhandle
	
enddo

!!retArr = !outArr
$P q var !!retArr
